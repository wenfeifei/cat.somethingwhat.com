using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Web;
using Cat.Foundation;
using Cat.M.Book.Services;
using Cat.Utility;
using Cat.Web.Support.Filter;
using Microsoft.AspNetCore.Mvc;

using AllPublicServices = Cat.M.Public.Services.AllServices;

namespace Cat.Web.Areas.Book.Controllers
{
    /// <summary>
    /// 书本搜索 控制器
    /// </summary>
    [AccessInterfaceRecord(RecordType = Enums.RecordType.wechat_new_mmbook)]
    public class SearchController : BaseController
    {
        readonly bool CloseOldInterface = Cat.Foundation.ConfigManager.BookSettings.CloseOldInterface.ToBoolean(true);

        /*
        /// <summary>
        /// 当前访问来源站点是否为“小程序线上环境”
        /// </summary>
        /// <returns></returns>
        private bool IsInOnlineEvn()
        {
            if (CatContext.HttpContext.Request.Headers["Referer"].ToStr().IndexOf("servicewechat.com") == -1)
                return false;
            if (CatContext.HttpContext.Request.Headers["Referer"].ToStr().IndexOf("devtools") > -1)
                return false;
            if (CatContext.HttpContext.Request.Headers["Referer"].ToStr().IndexOf("/0/page-frame.html") > -1)
                return false;
            return true;
        }
        */

        /// <summary>
        /// 测试访问来源站点是否在白名单内
        /// </summary>
        private void CheckInterfaceWhiteList()
        {
            var referer = CatContext.HttpContext.Request.Headers["Referer"].ToStr();

            if (string.IsNullOrEmpty(referer)) return;

            Regex MyRegex = new Regex(
                              "servicewechat\\.com\\/(?<appid>.*?)/(?<version>.*?)/page-frame\\.html",
                            RegexOptions.IgnoreCase
                            | RegexOptions.Multiline
                            | RegexOptions.IgnorePatternWhitespace
                            | RegexOptions.Compiled
                            );

            Match m = MyRegex.Match(referer);

            if (m == null || m.Groups.Count == 0) throw new Exception("Referer没有匹配到appid值");

            string appid = m.Groups.Where(w => w.Name == "appid").FirstOrDefault().Value;
            string version = m.Groups.Where(w => w.Name == "version").FirstOrDefault().Value;

            if (string.IsNullOrEmpty(appid) || string.IsNullOrEmpty(version)) throw new Exception("Referer没有匹配到appid值");

            //如果是“小程序线上环境”
            if (version.IsNumber() && Convert.ToInt16(version) > 0)
            {
                //测试访问来源站点是否在白名单内
                var instance = AllPublicServices.SysInterfaceWhiteListService.GetByAppid(appid);
                if (instance == null || instance.Validity_Time < DateTime.Now)
                {
                    throw new Exception("抱歉，小说接口不能用于小程序线上环境，仅供学习测试所用");
                }
            }

        }

        /// <summary>
        /// 获取所有搜索来源分类
        /// </summary>
        /// <returns></returns>
        public ActionRes GetBookCategoryList()
        {
            var data = AllServices.BookSearchService.GetBookCategoryList();
            data.FirstOrDefault().Active = true;
            return ActionRes.Success(data);
        }

        /// <summary>
        /// 搜索书本
        /// </summary>
        /// <returns></returns>
        public ActionRes GetBookList(string q, int pn, int rule)
        {
            CheckInterfaceWhiteList();

            //var res = Serializer.JsonDeserialize<ActionRes>("{\"Code\":0,\"Msg\":\"success\",\"Data\":[{\"bookname\":\"诛仙\",\"author\":\"萧鼎\",\"coverimg\":\"http://www.xxbiquge.com/cover/6/6482/6482s.jpg\",\"booktype\":\"武侠仙侠\",\"booklink\":\"http://www.xxbiquge.com/6_6482/\",\"intro\":\"这世间本是没有什么神仙的，但自太古以来，人类眼见周遭世界，诸般奇异之事，电闪雷鸣，狂风暴雨，又有天灾人祸，伤亡无数，…\",\"last_update_time\":\"2017-08-07\",\"last_update_chapter\":\"新书发布《诛仙前传:蛮荒行》\",\"chapterlink\":\"http://www.xxbiquge.com/6_6482/8201943.html\"},{\"bookname\":\"以武诛仙\",\"author\":\"大梦泣\",\"coverimg\":\"http://www.xxbiquge.com/cover/53/53999/53999s.jpg\",\"booktype\":\"武侠仙侠\",\"booklink\":\"http://www.xxbiquge.com/53_53999/\",\"intro\":\"穿越神魔世界，目睹仙神屠杀至亲，背负血海深仇，此生我修炼不为长生，不为逍遥，只为复仇，步步带血，我以武诛仙！\",\"last_update_time\":\"2017-08-22\",\"last_update_chapter\":\"新书《天蓬元帅》\",\"chapterlink\":\"http://www.xxbiquge.com/53_53999/2809582.html\"},{\"bookname\":\"一剑诛仙\",\"author\":\"猫蔻\",\"coverimg\":\"http://www.xxbiquge.com/cover/62/62538/62538s.jpg\",\"booktype\":\"女频频道\",\"booklink\":\"http://www.xxbiquge.com/62_62538/\",\"intro\":\"楚然坑了龙族一把，抢走了龙族唯一一滴真龙之血跑了。龙族大怒，发出悬赏令。然并卵——他从龙族之地逃走的时候，阵法出了问…\",\"last_update_time\":\"2017-08-22\",\"last_update_chapter\":\"129章\",\"chapterlink\":\"http://www.xxbiquge.com/62_62538/3497469.html\"},{\"bookname\":\"诛仙祭\",\"author\":\"流年花下\",\"coverimg\":\"http://www.xxbiquge.com/cover/48/48901/48901s.jpg\",\"booktype\":\"武侠仙侠\",\"booklink\":\"http://www.xxbiquge.com/48_48901/\",\"intro\":\"锲子：一眼一世界，一念一轮回...“如果这世间的秩序已经无法改变，如果这红尘的罪孽依旧要延续下去，那么就由我来亲手摧…\",\"last_update_time\":\"2017-08-22\",\"last_update_chapter\":\"第一百零六章 寻找上古幕府\",\"chapterlink\":\"http://www.xxbiquge.com/48_48901/2532266.html\"},{\"bookname\":\"逆诛仙\",\"author\":\"知邪\",\"coverimg\":\"http://www.xxbiquge.com/cover/14/14526/14526s.jpg\",\"booktype\":\"网游竞技\",\"booklink\":\"http://www.xxbiquge.com/14_14526/\",\"intro\":\"。——一句话简介:这就是前世略通皮毛的修真者误入诛仙世界的故事。PS:主角没看过诛仙233——\",\"last_update_time\":\"2017-08-21\",\"last_update_chapter\":\"第五十章 诸果之因\",\"chapterlink\":\"http://www.xxbiquge.com/14_14526/8527905.html\"},{\"bookname\":\"诛仙域\",\"author\":\"夜乌鱼\",\"coverimg\":\"http://www.xxbiquge.com/cover/27/27820/27820s.jpg\",\"booktype\":\"玄幻奇幻\",\"booklink\":\"http://www.xxbiquge.com/27_27820/\",\"intro\":\"成仙之路无尽头，神域滚滚仙血流。诸界天骄争主宰，唯我腾云傲天游。千万宇宙位面交错，构成一片神秘的世界。各界天骄汇集诛仙界，在此争霸。一名调皮捣蛋的少年，在凡尘中崛起，欲登上仙路与各界天骄争霸。\",\"last_update_time\":\"2017-08-20\",\"last_update_chapter\":\"第25章 大恐龙对秦首泉\",\"chapterlink\":\"http://www.xxbiquge.com/27_27820/1727730.html\"},{\"bookname\":\"诛仙诀\",\"author\":\"兔子吃窝边草\",\"coverimg\":\"http://www.xxbiquge.com/cover/6/6499/6499s.jpg\",\"booktype\":\"武侠仙侠\",\"booklink\":\"http://www.xxbiquge.com/6_6499/\",\"intro\":\"他是篮球的神话，他是足球界的传说，他是电影界的国王，他是音乐界的天才，他是商场的不败王者，他是黑道的三少，他是白道上…\",\"last_update_time\":\"2017-08-18\",\"last_update_chapter\":\"归来兮\",\"chapterlink\":\"http://www.xxbiquge.com/6_6499/7720948.html\"},{\"bookname\":\"诛仙图\",\"author\":\"念词\",\"coverimg\":\"http://www.xxbiquge.com/cover/40/40701/40701s.jpg\",\"booktype\":\"武侠仙侠\",\"booklink\":\"http://www.xxbiquge.com/40_40701/\",\"intro\":\"仙不将仙，天欲灭之；九天仙图，诛仙之路。我之道，顺仙则亡，逆仙成圣。我之意，破灭九天，昂首天外。缥缈修仙路，漫漫寻仙途，我欲灭天下群仙，傲睨一切！……诛仙之途舍我其谁！\",\"last_update_time\":\"2017-08-16\",\"last_update_chapter\":\"第五章 当第一\",\"chapterlink\":\"http://www.xxbiquge.com/40_40701/2136218.html\"},{\"bookname\":\"一念诛仙\",\"author\":\"离恨殇歌\",\"coverimg\":\"http://www.xxbiquge.com/cover/72/72996/72996s.jpg\",\"booktype\":\"玄幻奇幻\",\"booklink\":\"http://www.xxbiquge.com/72_72996/\",\"intro\":\"鼓乐喧。到头元知万事空，唯有亭台小溪流。只恨仇深仍未了，剑在手一念诛仙！\",\"last_update_time\":\"2017-08-09\",\"last_update_chapter\":\"第六十七章:开学跟我有什么关系\",\"chapterlink\":\"http://www.xxbiquge.com/72_72996/3873661.html\"},{\"bookname\":\"诛仙至尊\",\"author\":\"华星\",\"coverimg\":\"http://www.xxbiquge.com/cover/45/45880/45880s.jpg\",\"booktype\":\"玄幻奇幻\",\"booklink\":\"http://www.xxbiquge.com/45_45880/\",\"intro\":\"量小非君子，无毒不丈夫，我尝胆万年，决定磨刀霍霍向诸（猪）仙……辰天喃喃道。圣人不死，大盗不止；仙帝不亡，天下难定！…\",\"last_update_time\":\"2017-08-18\",\"last_update_chapter\":\"第四十三章 天下第一\",\"chapterlink\":\"http://www.xxbiquge.com/45_45880/2375954.html\"}],\"TraceIdentifier\":\"0HLE8C2VTHE12:00000001\"}");
            //return res;

            var data = AllServices.BookSearchService.GetBookList(rule, q, pn);
            return ActionRes.Success(data);
        }

        /// <summary>
        /// 获取小说章节目录信息
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public ActionRes GetBookChapter(string id)
        {
            CheckInterfaceWhiteList();

            //var res = Serializer.JsonDeserialize<ActionRes>("{\"Code\":0,\"Msg\":\"success\",\"Data\":{\"BookName\":\"诛仙\",\"BookLink\":null,\"Author\":\"萧鼎\",\"Status\":\"连载中\",\"Last_Update_Time\":\"2016-08-03 18:04:59\",\"Last_Update_ChapterName\":\"新书发布《诛仙前传:蛮荒行》\",\"Last_Update_ChapterLink\":\"http://www.xxbiquge.com/6_6482/8201943.html\",\"Intro\":\"这世间本是没有什么神仙的，但自太古以来，人类眼见周遭世界，诸般奇异之事，电闪雷鸣，狂风暴雨，又有天灾人祸，伤亡无数，哀鸿遍野，决非人力所能为，所能抵挡。遂以为九天之上，有诸般神灵，九幽之下，亦是阴魂归处，阎罗殿堂。于是神仙之说，流传于世。无数人类子民，诚心叩拜，向着自己臆想创造出的各种神明顶礼膜拜，祈福诉苦，香火鼎盛……　　方今之世，正道大昌，邪魔退避。汁大地山灵水秀，人气鼎盛，物产丰富，为正派诸\r\n\t\t\t\t各位书友要是觉得《诛仙》还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！\",\"Chapterlist\":[{\"ChapterName\":\"序章\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579097.html\"},{\"ChapterName\":\"第一章 青云\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579098.html\"},{\"ChapterName\":\"第二章 迷局\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579099.html\"},{\"ChapterName\":\"第三章 宏愿\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579100.html\"},{\"ChapterName\":\"第四章 惊变\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579101.html\"},{\"ChapterName\":\"第五章 入门\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579102.html\"},{\"ChapterName\":\"第六章 拜师\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579103.html\"},{\"ChapterName\":\"第七章 初始\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579104.html\"},{\"ChapterName\":\"第八章 传艺\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579105.html\"},{\"ChapterName\":\"第九章 佛与道\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579106.html\"},{\"ChapterName\":\"第十章 幽谷\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579107.html\"},{\"ChapterName\":\"第十一章 异变\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579108.html\"},{\"ChapterName\":\"第十二章 重逢\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579109.html\"},{\"ChapterName\":\"第十三章 奇才\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579110.html\"},{\"ChapterName\":\"第十四章 神通\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579111.html\"},{\"ChapterName\":\"第十五章 私传\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579112.html\"},{\"ChapterName\":\"第十六章 驱物\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579113.html\"},{\"ChapterName\":\"第十七章 赴会\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579114.html\"},{\"ChapterName\":\"第十八章 相逢\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579115.html\"},{\"ChapterName\":\"第十九章 抽签\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579116.html\"},{\"ChapterName\":\"第二十章 魔踪\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579117.html\"},{\"ChapterName\":\"第二十一章 黑夜\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579118.html\"},{\"ChapterName\":\"第二十二章 比试\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579119.html\"},{\"ChapterName\":\"第二十三章 神剑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579120.html\"},{\"ChapterName\":\"第二十四章 意外\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579121.html\"},{\"ChapterName\":\"第二十五章 运气\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579122.html\"},{\"ChapterName\":\"第二十六章 自尊\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579123.html\"},{\"ChapterName\":\"第二十七章 坚持\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579124.html\"},{\"ChapterName\":\"第二十八章 前四\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579125.html\"},{\"ChapterName\":\"第二十九章 奇术\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579126.html\"},{\"ChapterName\":\"第三十章 怀疑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579127.html\"},{\"ChapterName\":\"第三十一章 正道\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579128.html\"},{\"ChapterName\":\"第三十二章 下山\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579129.html\"},{\"ChapterName\":\"第三十三章 万蝠\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579130.html\"},{\"ChapterName\":\"第三十四章 古窟\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579131.html\"},{\"ChapterName\":\"第三十五章 妖人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579132.html\"},{\"ChapterName\":\"第三十六章 怪目\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579133.html\"},{\"ChapterName\":\"第三十七章 死灵渊\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579134.html\"},{\"ChapterName\":\"第三十八章 深渊\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579135.html\"},{\"ChapterName\":\"第三十九章?重逢\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579136.html\"},{\"ChapterName\":\"第四十章?黑水玄蛇\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579137.html\"},{\"ChapterName\":\"第四十一章?绝地\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579138.html\"},{\"ChapterName\":\"第四十二章 滴血洞\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579139.html\"},{\"ChapterName\":\"第四十三章 天书\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579140.html\"},{\"ChapterName\":\"第四十四章 金铃\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/6579141.html\"},{\"ChapterName\":\"第四十五章 伤痛\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186567.html\"},{\"ChapterName\":\"第四十六章 脱困\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186568.html\"},{\"ChapterName\":\"第四十七章 文士\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186569.html\"},{\"ChapterName\":\"第四十八章 小镇\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186570.html\"},{\"ChapterName\":\"第四十九章 看相\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186571.html\"},{\"ChapterName\":\"第五十章 妖狐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186572.html\"},{\"ChapterName\":\"第五十一章 玄火鉴\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186573.html\"},{\"ChapterName\":\"第五十二章 黑石洞\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186574.html\"},{\"ChapterName\":\"第五十三章 火龙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186575.html\"},{\"ChapterName\":\"第五十四章 异兽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186576.html\"},{\"ChapterName\":\"第五十五章 妖逝\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186577.html\"},{\"ChapterName\":\"第五十六章 共死\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186578.html\"},{\"ChapterName\":\"第五十七章 昌合城\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186579.html\"},{\"ChapterName\":\"第五十八章 出海\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186580.html\"},{\"ChapterName\":\"第五十九章 伤心\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186581.html\"},{\"ChapterName\":\"第六十章 戾气\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186582.html\"},{\"ChapterName\":\"第六十一章 风雨\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186583.html\"},{\"ChapterName\":\"第六十二章 旧人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186584.html\"},{\"ChapterName\":\"第六十三章 魔教\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186585.html\"},{\"ChapterName\":\"第六十四章 鬼王\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186586.html\"},{\"ChapterName\":\"第六十五章 隐忧\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186587.html\"},{\"ChapterName\":\"第六十六章 往事\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186588.html\"},{\"ChapterName\":\"第六十七章 吸血老妖\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186589.html\"},{\"ChapterName\":\"第六十八章 赤焰\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186590.html\"},{\"ChapterName\":\"第六十九章 青龙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186591.html\"},{\"ChapterName\":\"第七十章 往事\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186592.html\"},{\"ChapterName\":\"第七十一章 伏击\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186593.html\"},{\"ChapterName\":\"第七十二章 夔牛\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186594.html\"},{\"ChapterName\":\"第七十三章 绝境\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186595.html\"},{\"ChapterName\":\"第七十四章 幽姬\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186596.html\"},{\"ChapterName\":\"第七十五章 密谋\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186597.html\"},{\"ChapterName\":\"第七十六章 心意\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186598.html\"},{\"ChapterName\":\"第七十七章 茫然\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186599.html\"},{\"ChapterName\":\"第七十八章 审问\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186600.html\"},{\"ChapterName\":\"第七十九章 萧墙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186601.html\"},{\"ChapterName\":\"第八十章 计中计\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186602.html\"},{\"ChapterName\":\"第八十一章 祖师祠堂\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186603.html\"},{\"ChapterName\":\"第八十二章 古剑诛仙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186604.html\"},{\"ChapterName\":\"第八十三章 旧孽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186605.html\"},{\"ChapterName\":\"第八十四章 血咒\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186606.html\"},{\"ChapterName\":\"第八十五章 十年\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186607.html\"},{\"ChapterName\":\"第八十六章 远行\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186608.html\"},{\"ChapterName\":\"第八十七章 旧地\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186609.html\"},{\"ChapterName\":\"第八十八章 大王村\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186610.html\"},{\"ChapterName\":\"第八十九章 看相\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186611.html\"},{\"ChapterName\":\"第九十章 死泽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186612.html\"},{\"ChapterName\":\"第九十一章 好人野狗\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186613.html\"},{\"ChapterName\":\"第九十二章 螳螂\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186614.html\"},{\"ChapterName\":\"第九十三章 黄雀\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186615.html\"},{\"ChapterName\":\"第九十四章 末路\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186616.html\"},{\"ChapterName\":\"第九十五章 瘴气\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186617.html\"},{\"ChapterName\":\"第九十六章 奇花\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186618.html\"},{\"ChapterName\":\"第九十七章 夜谈\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186619.html\"},{\"ChapterName\":\"第九十八章 旧时意\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186620.html\"},{\"ChapterName\":\"第九十九章 异兆\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186621.html\"},{\"ChapterName\":\"第一百章 巨树\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186622.html\"},{\"ChapterName\":\"第一百零一章 故人情\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186623.html\"},{\"ChapterName\":\"第一百零二章 玄蛇\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186624.html\"},{\"ChapterName\":\"第一百零三章 黄鸟\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186625.html\"},{\"ChapterName\":\"第一百零四章 小灰\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186626.html\"},{\"ChapterName\":\"第一百零五章 鱼怪\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186627.html\"},{\"ChapterName\":\"第一百零六章 问讯\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186628.html\"},{\"ChapterName\":\"第一百零七章 古刹\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186629.html\"},{\"ChapterName\":\"第一百零八章 魔阵\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186630.html\"},{\"ChapterName\":\"第一百零九章 潜行\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186631.html\"},{\"ChapterName\":\"第一百一十章 玄火坛\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186632.html\"},{\"ChapterName\":\"第一百一十一章 暗杀\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186633.html\"},{\"ChapterName\":\"第一百一十二章 异兽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186634.html\"},{\"ChapterName\":\"第一百一十三章 天狐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186635.html\"},{\"ChapterName\":\"第一百一十四章 白狐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186636.html\"},{\"ChapterName\":\"第一百一十五章 脱困\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186637.html\"},{\"ChapterName\":\"第一百一十六章 希望\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186638.html\"},{\"ChapterName\":\"第一百一十七章 天水寨\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186639.html\"},{\"ChapterName\":\"第一百一十八章 寒夜\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186640.html\"},{\"ChapterName\":\"第一百一十九章 深痕\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186641.html\"},{\"ChapterName\":\"第一百二十章 追踪\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186642.html\"},{\"ChapterName\":\"第一百二十一章 七里峒\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186643.html\"},{\"ChapterName\":\"第一百二十二章 烈酒\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186644.html\"},{\"ChapterName\":\"第一百二十三章 祭坛\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186645.html\"},{\"ChapterName\":\"第一百二十四章 黎族\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186646.html\"},{\"ChapterName\":\"第一百二十五章 黑火\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186647.html\"},{\"ChapterName\":\"第一百二十六章 伤心\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186648.html\"},{\"ChapterName\":\"第一百二十七章 巫妖\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186649.html\"},{\"ChapterName\":\"第一百二十八章 心意\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186650.html\"},{\"ChapterName\":\"第一百二十九章 追踪\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186651.html\"},{\"ChapterName\":\"第一百三十章 传说\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186652.html\"},{\"ChapterName\":\"第一百三十一章 诡林\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186653.html\"},{\"ChapterName\":\"第一百三十二章 诀别\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186654.html\"},{\"ChapterName\":\"第一百三十三章 凶灵\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186655.html\"},{\"ChapterName\":\"第一百三十四章 复生\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186656.html\"},{\"ChapterName\":\"第一百三十五章 煞气\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186657.html\"},{\"ChapterName\":\"第一百三十六章 异术\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186658.html\"},{\"ChapterName\":\"第一百三十七章 招魂引\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186659.html\"},{\"ChapterName\":\"第一百三十八章 伤心人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186660.html\"},{\"ChapterName\":\"第一百三十九章 颓废\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186661.html\"},{\"ChapterName\":\"第一百四十章 偶遇\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186662.html\"},{\"ChapterName\":\"第一百四十一章 杀机\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186663.html\"},{\"ChapterName\":\"第一百四十二章 迷惘\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186664.html\"},{\"ChapterName\":\"第一百四十三章 劫数\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186665.html\"},{\"ChapterName\":\"第一百四十四章 不愿\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186666.html\"},{\"ChapterName\":\"第一百四十五章 偶遇\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186667.html\"},{\"ChapterName\":\"第一百四十六章 相见\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186668.html\"},{\"ChapterName\":\"第一百四十七章 毒计\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186669.html\"},{\"ChapterName\":\"第一百四十八章 会盟\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186670.html\"},{\"ChapterName\":\"第一百四十九章 内乱\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186671.html\"},{\"ChapterName\":\"第一百五十章 剧毒\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186672.html\"},{\"ChapterName\":\"第一百五十一章 疯狂\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186673.html\"},{\"ChapterName\":\"第一百五十二章 炼狱\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186674.html\"},{\"ChapterName\":\"第一百五十三章 不孝\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186675.html\"},{\"ChapterName\":\"第一百五十四章 夜饮\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186676.html\"},{\"ChapterName\":\"第一百五十五章 故居\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186677.html\"},{\"ChapterName\":\"第一百五十六章 拜祭\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186678.html\"},{\"ChapterName\":\"第一百五十七章 夜探\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186679.html\"},{\"ChapterName\":\"第一百五十八章 鬼道\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186680.html\"},{\"ChapterName\":\"第一百五十九章 秘密\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186681.html\"},{\"ChapterName\":\"第一百六十章 挣扎\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186682.html\"},{\"ChapterName\":\"第一百六十一章 寂寞\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186683.html\"},{\"ChapterName\":\"第一百六十二章 隐者\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186684.html\"},{\"ChapterName\":\"第一百六十三章 暗算\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186685.html\"},{\"ChapterName\":\"第一百六十四章 幻月\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186686.html\"},{\"ChapterName\":\"第一百六十五章 激斗\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186687.html\"},{\"ChapterName\":\"第一百六十六章 禁地\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186688.html\"},{\"ChapterName\":\"第一百六十七章 尘缘\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186689.html\"},{\"ChapterName\":\"第一百六十八章 赤焰\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186690.html\"},{\"ChapterName\":\"第一百六十九章 决战\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186691.html\"},{\"ChapterName\":\"第一百七十章 巫术\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186692.html\"},{\"ChapterName\":\"第一百七十一章 妖兽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186693.html\"},{\"ChapterName\":\"第一百七十二章 神剑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186694.html\"},{\"ChapterName\":\"第一百七十三章 诛仙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186695.html\"},{\"ChapterName\":\"第一百七十四章 噬血\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186696.html\"},{\"ChapterName\":\"第一百七十五章 逃亡\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186697.html\"},{\"ChapterName\":\"第一百七十六章 黑衣人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186698.html\"},{\"ChapterName\":\"第一百七十七章 禅室\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186699.html\"},{\"ChapterName\":\"第一百七十八章 俗世佛堂\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186700.html\"},{\"ChapterName\":\"第一百七十九章 苦海难渡\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186701.html\"},{\"ChapterName\":\"第一百八十章 孽缘\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186702.html\"},{\"ChapterName\":\"第一百八十一章 化解\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186703.html\"},{\"ChapterName\":\"第一百八十二章 阴霾\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186704.html\"},{\"ChapterName\":\"第一百八十三章 无字玉壁\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186705.html\"},{\"ChapterName\":\"第一百八十四章 天刑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186706.html\"},{\"ChapterName\":\"第一百八十五章 难渡\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186707.html\"},{\"ChapterName\":\"第一百八十六章 密令\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186708.html\"},{\"ChapterName\":\"第一百八十七章 疯狗\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186709.html\"},{\"ChapterName\":\"第一百八十八章 收魂\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186710.html\"},{\"ChapterName\":\"第一百八十九章 鬼道\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186711.html\"},{\"ChapterName\":\"第一百九十章 惊现\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186712.html\"},{\"ChapterName\":\"第一百九十一章 鲜血\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186713.html\"},{\"ChapterName\":\"第一百九十二章 异样\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186714.html\"},{\"ChapterName\":\"第一百九十三章 泄密\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186715.html\"},{\"ChapterName\":\"第一百九十四章 暗伤\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186716.html\"},{\"ChapterName\":\"第一百九十五章 决定\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186717.html\"},{\"ChapterName\":\"第一百九十六章 足迹\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186718.html\"},{\"ChapterName\":\"第一百九十七章 旧地\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186719.html\"},{\"ChapterName\":\"第一百九十八章 功德\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186720.html\"},{\"ChapterName\":\"第一百九十九章 真怒\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186721.html\"},{\"ChapterName\":\"第二百章 迷局\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186722.html\"},{\"ChapterName\":\"第二百零一章 情伤\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186723.html\"},{\"ChapterName\":\"第二百零二章 黑蝠\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186724.html\"},{\"ChapterName\":\"第二百零三章 异人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186725.html\"},{\"ChapterName\":\"第二百零四章 天狐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186726.html\"},{\"ChapterName\":\"第二百零五章 神秘人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186727.html\"},{\"ChapterName\":\"第二百零六章 重逢\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186728.html\"},{\"ChapterName\":\"第二百零七章 断剑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186729.html\"},{\"ChapterName\":\"第二百零八章 心机\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186730.html\"},{\"ChapterName\":\"第二百零九章 魔兽\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186731.html\"},{\"ChapterName\":\"第二百一十章 追逐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186732.html\"},{\"ChapterName\":\"第二百一十一章 恐怖\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186733.html\"},{\"ChapterName\":\"第二百一十二章 八荒火龙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186734.html\"},{\"ChapterName\":\"第二百一十三章 末日\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186735.html\"},{\"ChapterName\":\"第二百一十四章 拥抱\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186736.html\"},{\"ChapterName\":\"第二百一十五章 回归\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186737.html\"},{\"ChapterName\":\"第二百一十六章 心魔\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186738.html\"},{\"ChapterName\":\"第二百一十七章 秘密\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186739.html\"},{\"ChapterName\":\"第二百一十八章 弑师\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186740.html\"},{\"ChapterName\":\"第二百一十九章 血阵\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186741.html\"},{\"ChapterName\":\"第二百二十章 故乡\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186742.html\"},{\"ChapterName\":\"第二百二十一章 暗算\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186743.html\"},{\"ChapterName\":\"第二百二十二章 猥琐\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186744.html\"},{\"ChapterName\":\"第二百二十三章 会聚\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186745.html\"},{\"ChapterName\":\"第二百二十四章 相救\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186746.html\"},{\"ChapterName\":\"第二百二十五章 心意\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186747.html\"},{\"ChapterName\":\"第二百二十六章 重逢\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186748.html\"},{\"ChapterName\":\"第二百二十七章 诛心\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186749.html\"},{\"ChapterName\":\"第二百二十八章 别离\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186750.html\"},{\"ChapterName\":\"第二百二十九章 伤口\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186751.html\"},{\"ChapterName\":\"第二百三十章 回家\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186752.html\"},{\"ChapterName\":\"第二百三十一章 亲人\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186753.html\"},{\"ChapterName\":\"第二百三十二章 血兆\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186754.html\"},{\"ChapterName\":\"第二百三十三章 绝望\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186755.html\"},{\"ChapterName\":\"第二百三十四章 无憾\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186756.html\"},{\"ChapterName\":\"第二百三十五章 困惑\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186757.html\"},{\"ChapterName\":\"第二百三十六章 杀意\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186758.html\"},{\"ChapterName\":\"第二百三十七章 悲哀\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186759.html\"},{\"ChapterName\":\"第二百三十八章 别离\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186760.html\"},{\"ChapterName\":\"第二百三十九章 阴谋\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186761.html\"},{\"ChapterName\":\"第二百四十章 普德\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186762.html\"},{\"ChapterName\":\"第二百四十一章 异宝\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186763.html\"},{\"ChapterName\":\"第二百四十二章 恐惧\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186764.html\"},{\"ChapterName\":\"第二百四十三章 希望\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186765.html\"},{\"ChapterName\":\"第二百四十四章 乾坤锁\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186766.html\"},{\"ChapterName\":\"第二百四十五章 奈何\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186767.html\"},{\"ChapterName\":\"第二百四十六章 星盘\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186768.html\"},{\"ChapterName\":\"第二百四十七章 等待\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186769.html\"},{\"ChapterName\":\"第二百四十八章 暗斗\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186770.html\"},{\"ChapterName\":\"第二百四十九章 凶猴\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186771.html\"},{\"ChapterName\":\"第二百五十章 妖物\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186772.html\"},{\"ChapterName\":\"第二百五十一章 死别\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186773.html\"},{\"ChapterName\":\"第二百五十二章 依偎\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186774.html\"},{\"ChapterName\":\"第二百五十三章 灵牌\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186775.html\"},{\"ChapterName\":\"第二百五十四章 召唤\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186776.html\"},{\"ChapterName\":\"第二百五十五章 天道\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186777.html\"},{\"ChapterName\":\"第二百五十六章 诛仙\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186778.html\"},{\"ChapterName\":\"尾声\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8186779.html\"},{\"ChapterName\":\"新书发布《诛仙前传:蛮荒行》\",\"ChapterLink\":\"http://www.xxbiquge.com/6_6482/8201943.html\"}]},\"TraceIdentifier\":\"0HLFEOE67UJJ3:00000004\"}");
            //return res;

            var bookReadRecordInstance = AllServices.BookReadRecordService.GetSingle(id);
            if (bookReadRecordInstance == null) throw new Exception("没有找到书本信息，请重新进入再试");

            var data = AllServices.BookSearchService.GetBookChapter(bookReadRecordInstance.Rule, bookReadRecordInstance.Book_Link);

            //最近一次阅读的信息
            if (!string.IsNullOrEmpty(bookReadRecordInstance.Last_Reading_Record_Id))
            {
                var _tempInstance = AllServices.BookChapterReadRecordService.GetSingle(bookReadRecordInstance.Last_Reading_Record_Id);
                if (_tempInstance != null)
                {
                    data.Last_Reading_ChapterLink = _tempInstance.Chapter_Link;
                    data.Last_Reading_ChapterName = _tempInstance.Chapter_Name;
                }
            }

            return ActionRes.Success(data);
        }

        /// <summary>
        /// 获取小说的内容
        /// </summary>
        /// <param name="id"></param>
        /// <param name="link"></param>
        /// <returns></returns>
        public ActionRes GetBookContent(string id, string link)
        {
            CheckInterfaceWhiteList();

            //var res = Serializer.JsonDeserialize<ActionRes>("{\"Code\":0,\"Msg\":\"success\",\"Data\":{\"BookName\":\"诛仙\",\"BookLink\":\"https://www.xxbiquge.com/6_6482/6579099.html\",\"ChapterName\":\"第二章 迷局\",\"ChapterLink\":\"https://www.xxbiquge.com/6_6482/\",\"Content\":\"　　那老僧不答，只用目光在这两个小孩身上细细看了看，忍不住便多看了林惊羽几眼，心道：“好资质，只是性子怎么却如此偏激？”\n\n　　这时张小凡踏上一步，道：“喂，你是谁啊，怎么从没见过你？”\n\n　　草庙村在青云门附近，这里道教为尊，佛家弟子极为少见，故张小凡有此一问。\n\n　　老僧看了他一眼，嘴角露出一丝笑意，反问道：“小施主，刚才性命交关，你只要认个输便是了，为何却要苦苦支撑，若非老衲出手，你只怕已白白送了性命！”\n\n　　张小凡呆了一呆，心里觉得这老和尚说的未尝没有道理，只是事到临头，他却还是说不出所以然来，只得怔在那里。\n\n　　林惊羽瞪了老僧一眼，拉了张小凡的手，道：“小凡，这老和尚古里古怪，我们别理他。”说完便拉他向外边走去，几个孩子都跟了过去，显然一向以他马是瞻。\n\n　　张小凡下意识地也迈开脚步，只是他走出庙门一段路后，忍不住又回头向庙里看去，只见天色渐暗，依稀可以看见那老和尚依然站在那里，只是面容已模糊不清了。\n\n　　※※※\n\n　　夜深。\n\n　　一声雷鸣，风卷残云，天边黑云翻滚。\n\n　　风雨将欲来，一片肃杀意。\n\n　　老僧仍在草庙之中，席地打坐。抬眼看去，远方青云山只剩下了一片朦胧，四野静无人声，只有漫天漫地的急风响雷。\n\n　　好一场大风！\n\n　　一道闪电裂空而过，这座在风中孤独伫立的小草庙亮了一亮，只见那老僧在这片刻间已站在了庙门口，一脸严肃，抬眼看天，双眉越皱越紧。\n\n　　西边村子中，不知何时已起了一股黑气，浓如黑墨，翻涌不止。老僧站在草庙之中，死死盯着这股黑气。\n\n　　忽然，那股黑气一卷，盘旋而起，径直便往村外而去，正向着草庙方向而来。它度极快，转眼即至。老僧眼尖，一眼看见其中竟夹带着一个小孩，正是白天见过的林惊羽。\n\n　　老僧脸色一沉，再不迟疑，也不见他如何作势，枯瘦身子霍地拔地而起，直插入黑气之中。\n\n　　黑暗中不知名处，传来了一声微带讶意的声音：“咦？”\n\n　　几声闷响，黑气霍然止住，在草庙上空盘旋不去。老僧肋下夹着林惊羽，缓缓落下，但身后袈裟已被撕去了一块。\n\n　　借着微弱光线，只见林惊羽双目紧闭，呼吸平稳，也不知是睡了还是昏了过去。\n\n　　老僧没有放下他，抬头看着空中那团黑气，道：“阁下道法高深，为何对无知孩童下手，只怕失了身份罢？”\n\n　　黑气中传来一个沙哑声音，道：“你又是谁，敢管我闲事？”\n\n　　老僧不答，却道：“此处乃青云山下，若为青云门知道阁下在此地胡作非为，只怕阁下日后就不好过了。”\n\n　　那人“呸”了一声，语带不屑，道：“青云门算什么，就仗着人多而已。老秃驴莫要多说，识相的就快快把那小孩给我。”\n\n　　老僧合十道：“阿弥佗佛，出家人慈悲为怀，老衲断不能眼睁睁看着这小孩遭你毒手。”\n\n　　那人怒道：“好贼秃，你是找死。”\n\n　　随着他的话语，原来一直盘旋的黑气中，一道深红异芒在其中闪了一闪，刹那间这小小草庙周围，阴风大作，鬼气大盛。\n\n　　“毒血幡！”老僧脸上突现怒容，“孽障，你竟然敢修炼此等丧尽天良、祸害人间的邪物，今日决计饶不了你。”\n\n　　那沙哑声音一声冷笑，却不答话，只听一声呼啸，红芒大盛，从半空之中，腥臭之气大作，一面两丈红幡缓缓祭起。这时，鬼哭之声越凄厉，似有无数怨灵夜哭，其间还隐隐有骨骼作响声，闻之惊心。\n\n　　“贼秃，受死！”那黑气中人一声断喝，只见从那血色红幡之上，突现狰狞鬼脸，有三角四眼，尖齿獠牙，“咔、咔、咔、咔”骨骼乱响处，鬼脸上的四只眼睛突然全部睁开，“吼”地一声，竟化为实体，从幡上冲出，带着无比血腥之气，击向老僧。\n\n　　老僧脸上怒色更重，知道这毒血幡威力越大，修炼过程中害死的无辜之人势必更多。要炼成眼前这般威势，只怕要以三百人以上精血祭幡方才可以。\n\n　　这邪人实在丧尽天良！\n\n　　眼看那鬼物就要冲要眼前，老僧却并不放下肋下小孩林惊羽，只用持着碧玉念珠的左手，在身前虚空画圆，单手结佛门狮子印，五指屈伸，指尖隐隐出金光，片刻间已在身前欢出一面金色法轮，金光辉煌，与那鬼物抵持在半空中。\n\n　　“小小伎俩，也来卖”他一个“弄”字还未说完，突然全身大震，只觉得右手抱着小孩林惊羽处，手腕被异物咬了一口，一股麻痒感觉立时行遍半身，眼前一黑，身前法轮登时摇摇欲坠。\n\n　　而正在此时，前方那个鬼物又有诡异变化，在它左右四眼正中额头上，“咔、咔”两声，竟又开了一只血红巨目，腥风大起，威势更重，只听一声鬼嚎，血色红光闪过，那鬼物将金色法轮击得粉碎，重重打在老僧胸口。\n\n　　老僧整个人被打得向后飞了起来，肋下的林惊羽也掉在了地上，途中几声闷响，怕是肋骨已尽数断了。片刻之后，他枯瘦的身子砸在草庙壁上，“轰”地一声，尘土飞扬，一整面墙都塌了下来。\n\n　　“哈哈哈哈哈~~~~~~~~”黑气中人一阵狂笑，得意无比。\n\n　　老僧颤巍巍地站起，喉咙一热，忍不住一口热血喷了出来，把身前僧衣都染红了。他只觉得眼前金星乱闪，全身剧痛而那股麻痒感觉也越来越逼近了心脏。\n\n　　他强自镇定心神，眼角扫过倒在地上兀自昏迷的林惊羽，却见在他衣襟之中，缓缓爬出一只彩色蜈蚣，个大如掌，最奇异的是它尾部分了七叉，看去仿佛有七条尾巴似的。而且每一只各呈一色，各不相同，色彩绚丽，只是美丽中却带了几分可怖。\n\n　　“七尾蜈蚣！”老僧的话听起来像是一声呻吟。\n\n　　他脸上黑气越来越重，嘴角也不断流出血来，似乎已是难以支撑，但仍然强撑着不愿倒下。他看着半空中那团黑气，道：“你将这天下奇毒之物放在那孩子身上，又故意隐藏实力，看准机会一击伤我，你是冲着我来的吧？”\n\n　　黑气中人“嘿嘿”冷笑一声，道：“不错，我便是专门冲着你普智秃驴来的。若非如此，凭你一身天音寺佛门修行，倒也不好对付。好了，现在快快把‘噬血珠’交出来，我便给你七尾蜈蚣的解药，饶你不死！”\n\n　　普智惨笑一声，道：“枉我名中还有一个‘智’字，竟想不到你炼这毒血幡邪物，岂有不贪图‘噬血珠’的道理。”他脸色一肃，断然道：“要我将这世间至凶之物给你，却是妄想。”\n\n　　那黑气中人大怒：“那你便去见你的佛祖吧。”红芒一闪，毒血幡迎风招摇，鬼哭声声，巨大鬼物再现，在空中微一盘旋，再次冲向普智。\n\n　　普智一声大喝，全身衣袍无风自鼓，原本瘦小的身躯似乎涨大了许多。他左手用力处，只听一声脆响，那串碧玉念珠已为他捏断，十几颗晶莹剔透的念珠竟不下坠，反而滴溜溜转个不停，一个个出青光，浮在普智身前，只有那一颗深紫圆珠，却径直掉下。\n\n　　普智手掌一翻，将那深紫珠子一把抓在手中，双手即结左右水瓶印，两目圆睁，全身上下隐有金光，口中一字一字念道：“奄、嘛、呢、叭、弥、哞！”\n\n　　“六字大明咒。”黑气中人的口气立时多了几分凝重。\n\n　　随着普智“哞”字声落，刹那间所有碧玉念珠一起大放光芒，同一时刻，那邪人祭起的鬼物已冲到跟前，血腥之气扑面而来。但一接触到到碧玉青光，顿时化为无形，不能进前，就此僵持在半空。\n\n　　饶是如此，普智的身子又是一阵摇晃，七尾蜈蚣是天下绝毒之物，以他数百年的修行，仍然难以抵挡。只是他隐泛黑气的脸上，却露出淡淡一丝笑容，带了几分凛然。\n\n　　“呔！”\n\n　　普智一声大喝，如做狮子吼，声震四野，身前碧玉念珠受佛力驱弛，光芒更盛，忽地一颗念珠“噗”地一声碎裂，在半空中幻做一个“佛”字，疾冲向前，打在那鬼物脸上。\n\n　　“哇~~~~~呀！”那鬼物一声凄厉嚎叫，登时退了几步，周身红芒大为衰退，显然已受了伤。黑气中人怒道“好个秃驴！”\n\n　　他正要动作，只是说时迟那时快，片刻间七、八颗念珠都幻做佛家真言打中鬼物。那鬼物嚎叫不止，连连退避，做恐惧状，在被第九颗碧玉念珠击中时，终于一声长嚎，五目齐齐迸裂，骨骼乱响，“轰”地一声跌落在地，挣扎了几下，便僵直不动，缓缓化做血水，腥臭无比。\n\n　　与此同时，普智却“哇”地一声，又喷出一大口血，而血的颜色，已成了黑的。\n\n　　“啊！”一声尖叫，在这两大高人斗法的紧要关头，从草庙门口传来。\n\n　　普智和那邪人都吃了一惊，天上黑气一动，普智也同时向门口看去，只见日间见到的小孩张小凡，不知为何来到了这草庙之前，站在门口，目瞪口呆地看着庙中这奇异景象。\n\n　　黑气中人一声冷哼，也不见他如何动作，那只原来爬在林惊羽身上的七尾蜈蚣忽然振尾，借势飞起，疾如闪电，向那张小凡飞去。\n\n　　普智双眉一竖，右手一指，一颗碧玉念珠急冲而至。那七尾蜈蚣竟似通灵，知道厉害，不敢抵挡，尾巴一振，便如翅膀一般折冲而起，投入黑气之中，再无声息。\n\n　　黑气中人阴森森地道：“嘿嘿，果然不愧是天音寺四大神僧，重伤之下，还能破了我的‘毒血尸王’，但你收尸王一击，又中七尾蜈蚣之毒，还能撑多久？还是乖乖地把‘噬血珠’给我吧。”\n\n　　普智此刻便连眼角也开始流出黑血，惨笑一声，嘶声道：“老衲就算今日毙命于此，也要除了你这个妖人。”\n\n　　话声一落，他身前所有碧玉念珠同时亮了起来，空中那人立刻戒备，忽然间一声呼啸，一物闪着青光从后面撞入黑气，却是刚才击向七尾蜈蚣的那颗碧玉念珠，在空中飞出了一段，被普智暗中操控，折到黑气后边，猝起难。\n\n　　只听黑气中一声怒吼，显然那人猝不及防，“砰、砰、砰”几声乱响，青芒闪处，黑气散乱，最终四处散开，化于无形。从半空中缓缓落下一个高瘦之人，全身上下用黑袍紧紧包住，看不清容貌岁数，只有一双眼睛，凶光闪闪，在他背后，还绑着一把长剑。\n\n　　普智低声道：“阁下如此道行，怎地却不敢见人么？”\n\n　　黑衣人眼中凶光闪动，厉声道：“秃驴，今日让你死无葬身之地！”\n\n　　说罢，他反手“刷”地一声拔出背后长剑，只见此剑清如秋水，亮不刺目，有淡淡清光，附于其上。\n\n　　“好剑。”普智忍不住叫了一声。\n\n　　那黑衣人一声低哼，手握剑诀，脚踏七星，连行七步，长剑霍然刺天，口中念念有词：\n\n　　“九天玄刹，化为神雷。\n\n　　煌煌天威，以剑引之！”\n\n　　片刻之间，天际乌云顿时翻涌不止，雷声隆隆，黑云边缘不断有电光闪动，天地间一片肃杀，狂风大做。\n\n　　“神剑御雷真诀！”普智的脸色在刹那间苍白如灰，随之而起的是一种惊讶，一丝绝望和一点点莫名的狂热。\n\n　　“你竟是青云门下！”——\n\n　　ps：\n\n　　文中普智所诵之“奄、嘛、呢、叭、弥、哞！”，即有名的“六字大明咒”，佛家经典中又称“观音灵感真言”。佛经中载：此真言通天地造化，诵之可脱尘埃，涤心镜，至大欢喜极乐境界。是佛家中最著名的经典真言咒文之一。\n\n　　现将全文附录如下：\n\n　　口奄嘛呢叭弥哞，麻葛倪牙纳，积都特巴达，积特些纳，微达哩葛，萨而翰而塔，卜哩悉塔葛，纳补罗纳，纳卜哩，丢2班纳，捺麻庐吉，说罗耶莎珂。\",\"NextChapterLink\":\"https://www.xxbiquge.com/6_6482/6579100.html\",\"PrevChapterLink\":\"https://www.xxbiquge.com/6_6482/6579098.html\",\"Number_Of_Words\":4336},\"TraceIdentifier\":\"0HLFERJOS8GF9:00000001\"}");
            //return res;

            var bookReadRecordInstance = AllServices.BookReadRecordService.GetSingle(id);
            if (bookReadRecordInstance == null) throw new Exception("没有找到书本信息，请重新进入再试");
            if (string.IsNullOrEmpty(link)) throw new Exception("没有指定link，请重新进入再试");

            //用户信息
            var user = AllServices.BookUserService.GetSingleByOpenId(base.Openid);

            link = HttpUtility.UrlDecode(link);

            var data = AllServices.BookSearchService.GetBookContent(bookReadRecordInstance.Rule, link);
            data.AlreadyCollected = bookReadRecordInstance.AlreadyCollected.ToBoolean();
            data.Currency = user.Currency;
            return ActionRes.Success(data);
        }

    }
}